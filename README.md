# Фамильяр - Локальный ИИ-ассистент

Прототип локального ИИ-помощника, разрабатываемый Искрой и Gemini в качестве совместного обучающего проекта. Помощник использует локально запущенную LLM (Mistral через Ollama) для распознавания естественного языка (NLU) и выполнения команд на компьютере пользователя.

## Текущие Возможности (Реализованные Интенты NLU)

На данный момент NLU-модель обучена распознавать следующие намерения (интенты) и параметры:

* **`manage_app`**: Запустить приложение или сфокусироваться на нем (`action: "open"`), закрыть приложение (`action: "close"`).
    * `app_name` (string): Имя или алиас приложения.
* **`manage_system`**: Управление системой.
    * `action` (string): "reboot", "update", "shutdown".
* **`manage_sound`**: Управление громкостью.
    * `action` (string): "up", "down", "mute", "unmute".
    * `amount` (string, optional): Уровень или степень изменения (например, "50%", "немного").
* **`add_alias`**: Добавить псевдоним для приложения.
    * `alias_name` (string): Новый псевдоним (обычно кириллицей).
    * `canonical_name` (string): Оригинальное (каноническое) имя приложения.
* **`ask_time`**: Узнать текущее время.
* **`web_search`**: Выполнить поиск в интернете.
    * `query` (string): Поисковый запрос.
* **`set_reminder`**: Установить напоминание.
    * `reminder_text` (string): Текст напоминания.
    * `time_spec` (string): Время/условие напоминания (например, "через час", "завтра в 10").
* **`set_alarm`**: Установить будильник.
    * `time_spec` (string): Время будильника (например, "7 утра", "06:30").
* **`unknown`**: Команда не распознана.

*(Примечание: Реализация **обработчиков** для всех этих интентов в `command_dispatcher.py` и `intent_handlers/` находится в процессе разработки).*

## Структура Проекта

Проект имеет модульную структуру для лучшей читаемости и расширяемости:

* `familiar.py`: Главный исполняемый файл, точка входа, цикл обработки команд.
* `nlu_processor.py`: Отправка запросов к Ollama API, извлечение JSON из ответа LLM.
* `command_dispatcher.py`: Маршрутизация распознанных интентов к соответствующим обработчикам.
* `utils.py`: Вспомогательные функции (например, загрузка/сохранение алиасов).
* `config/`: Папка для конфигурационных файлов.
    * `app_aliases.json`: Словарь псевдонимов приложений.
* `actions/`: Папка с модулями, выполняющими низкоуровневые действия.
    * `manage_app_action.py`: Функции для запуска, поиска PID, активации окна приложения.
    * `close_app_action.py`: Функция для завершения процесса приложения.
    * *(В будущем: модули для управления звуком, системой и т.д.)*
* `intent_handlers/`: Папка с модулями-обработчиками для каждого интента.
    * `handle_manage_app.py`: Логика для `manage_app`.
    * `handle_close_app.py`: Логика для `close_app`.
    * *(И другие обработчики для остальных интентов)*

## Установка (Предварительно)

* Python 3.x
* Ollama с загруженной моделью Mistral (или другой)
* Зависимости Python: `requests`, `psutil` (установить через `pip install requests psutil`)
* Для Linux (для активации окон): `wmctrl` (установить через менеджер пакетов, например, `sudo apt install wmctrl`)

## Использование

1.  Убедитесь, что Ollama запущена и доступна по адресу, указанному в `nlu_processor.py` (по умолчанию `http://localhost:11434/api/generate`).
2.  Запустите главный скрипт из корневой папки проекта:
    ```bash
    python familiar.py
    ```
3.  Для отладки NLU используйте флаг `--debug`:
    ```bash
    python familiar.py --debug
    ```
4.  Введите команду в консоли.

## Планы на Будущее / TODO

* Реализовать логику для всех обработчиков интентов в `intent_handlers/`.
* Реализовать соответствующие функции действий в `actions/` (управление звуком, перезагрузка/обновление, поиск, напоминания, будильники).
* Реализовать интерфейс через Телеграм-бота.
* Вынести настройки (URL API, имя модели, шаг громкости и т.д.) в конфигурационный файл.
* Добавить обработку ошибок и более информативные ответы пользователю.
* (Опционально) Рассмотреть переход на ООП для обработчиков при усложнении.
* (Опционально) Добавить модуль распознавания речи и синтеза речи.